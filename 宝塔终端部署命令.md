# 宝塔面板终端部署命令 - v0.96版本

## 🔧 准备工作
1. 登录宝塔面板
2. 进入"终端"功能
3. 确认你的网站目录路径

## 📋 分步执行命令

### 步骤1: 进入网站目录并备份
```bash
# 进入你的网站目录 (请修改为实际路径)
cd /www/wwwroot/你的域名

# 创建备份
cp -r . ../backup_$(date +%Y%m%d_%H%M%S)
echo "✅ 当前版本已备份"
```

### 步骤2: 拉取最新代码
```bash
# 如果已有Git仓库
git fetch origin
git checkout main  
git pull origin main
git checkout v0.96

# 如果是首次部署 (没有Git)
# git clone https://github.com/a921198345/studypartner007.git .
# git checkout v0.96
```

### 步骤3: 安装依赖和构建
```bash
# 安装依赖
npm install --production

# 构建项目  
npm run build
```

### 步骤4: 重启服务
```bash
# 查看当前PM2进程
pm2 list

# 重启应用 (如果已存在)
pm2 restart law-exam-assistant

# 或者启动新进程 (如果不存在)
pm2 start npm --name "law-exam-assistant" -- start

# 保存PM2配置
pm2 save
```

### 步骤5: 验证部署
```bash
# 查看进程状态
pm2 status

# 查看日志
pm2 logs law-exam-assistant --lines 20

# 测试网站响应
curl -I http://localhost:3000
```

## 🚨 一键执行脚本
如果你想一次性执行所有命令，可以下载并运行部署脚本：

```bash
# 下载脚本 (需要先上传到服务器)
wget https://raw.githubusercontent.com/a921198345/studypartner007/main/deploy-to-baota.sh

# 或者直接复制脚本内容创建文件
nano deploy.sh
# 粘贴脚本内容后保存

# 添加执行权限
chmod +x deploy.sh

# 执行部署
./deploy.sh
```

## 🔍 常见问题解决

### 如果遇到权限问题：
```bash
chown -R www:www /www/wwwroot/你的域名
chmod -R 755 /www/wwwroot/你的域名
```

### 如果Node.js版本不兼容：
```bash
# 查看当前版本
node -v
npm -v

# 如需更新 (通过宝塔软件商店或手动安装)
```

### 如果端口冲突：
```bash
# 查看端口占用
netstat -tlnp | grep :3000

# 杀死占用进程
kill -9 PID
```

## 📞 回滚方案
如果部署出现问题，可以快速回滚：

```bash
# 停止当前服务
pm2 stop law-exam-assistant

# 恢复备份
cp -r ../backup_* .

# 重启服务
pm2 restart law-exam-assistant
```