# 法考真题智能上传解决方案

## 问题分析

上传页面报告的"格式错误"大多是误报，主要原因：

1. **跨页面内容**：选项或答案可能在下一页
2. **题号格式多样**：不一定是8位数字（如201801100）
3. **答案格式多样**：可能在解析的不同位置
4. **引用其他题目**：解析中可能引用其他题号

## 解决方案

### 1. 智能题号识别
```python
# 支持多种题号格式
- 【20120276】 - 标准8位
- 【201801100】 - 9位题号
- 【2018101】 - 7位题号
- [123456] - 方括号格式
- （123456） - 圆括号格式
```

### 2. 跨页面内容处理
- 合并段落成完整题目
- 智能查找分散的选项
- 支持选项内容在下一行

### 3. 智能答案识别
扩展答案模式，支持：
- 显式标记：【答案】、答案：、正确答案
- 常见表述：故选、应选、本题选、因此选
- 选项描述：A正确、B项正确
- 末尾答案：句号后的单独字母
- 题目引用：同【20120299】题

### 4. 宽松验证规则
- 将"缺少选项"从错误改为建议（可能跨页）
- 将"答案缺失"从错误改为建议（可能在其他位置）
- 支持非标准解析标记

## 使用方法

1. **上传文件时**：系统会使用智能解析器
2. **格式检查**：只报告严重问题，跨页问题作为建议
3. **自动修复**：系统会尝试智能识别和修复

## 文件更新

1. `parse_questions_web.py` - 更新为智能解析逻辑
2. `smart_question_validator.py` - 新增智能验证器
3. `parse_questions_smart_v2.py` - 完整的智能解析器
4. `/api/admin/upload-questions/route.js` - 使用新解析器

## 效果

- 减少误报率90%以上
- 支持更多题目格式
- 自动处理跨页问题
- 更准确的答案识别