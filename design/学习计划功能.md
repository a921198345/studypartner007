# 法考学习计划功能 · V3 需求文档

> 本文档基于简化设计，专注核心功能，提供清晰的用户体验流程

---

## 0. 功能概览
1. **重新制定计划按钮**（LearningPlan 页面入口）  
2. 点击后进入**分步骤问卷流程**，用户逐步完成计划设置  
3. 提交后 → AI 生成 **总体规划思路 + 日计划 + 周计划**  
4. 用户可反馈重新生成或确认计划  
5. 确认后写入学习计划数据库  

---

## 1. 问卷流程（分步骤）

### 步骤1：选择当前学习进度
**界面说明**：显示所有法考科目列表，每个科目有三个选项
- **已完成**：该科目已学完
- **未开始**：该科目尚未开始学习  
- **进行中**：该科目正在学习（选择此项进入步骤1.1）

**科目列表**：
- 民法
- 刑法  
- 行政法
- 刑事诉讼法
- 民事诉讼法
- 商经法
- 理论法
- 三国法

### 步骤1.1：选择具体进度（仅对"进行中"科目）
**界面说明**：
- 显示该科目的所有章节列表（参考上传的章节图片结构）
- 使用**垂直滑动进度条**，用户可上下滑动选择当前学习位置
- 进度条显示章节名称，用户滑到当前学习的章节即可
- 系统自动计算该科目的完成百分比

### 步骤2：选择科目学习顺序
**界面说明**：
- 显示所有**未完成**的科目（已完成的科目不参与排序）
- 提供两种选择方式：
  - **手动排序**：用户拖拽调整科目顺序
  - **AI 智能排序**：系统根据以下因素自动排序
    - 用户当前进度（优先安排进度多的科目）
    - 各科目重要程度权重
    - 科目难易程度
    - 科目间的关联性

### 步骤3：设置学习时间
**界面说明**：简单的选择界面
- **每日学习时长**：1h / 2h / 3h / 4h / 5h+（单选）
- **每周学习天数**：3天 / 4天 / 5天 / 6天 / 7天（单选）

### 步骤4：自定义说明（可选）
**界面说明**：
- 文本输入框，用户可填写特殊需求
- **引导词示例**：
  - "我的薄弱环节是..."
  - "我希望重点加强..."  
  - "我的时间安排特殊情况..."
  - "其他特殊要求..."
- 该步骤可跳过

### 步骤5：生成计划
**界面说明**：
- 显示"正在生成计划..."加载动画
- 调用 AI API 生成个性化学习计划

---

## 2. 计划预览与反馈
**界面说明**：
- 显示生成的学习计划（总体规划思路 + 日计划 + 周计划）
- 提供两个按钮：
  - **反馈并重新生成**：用户可输入反馈意见
  - **确认计划**：确认使用此计划

### 反馈重新生成流程
- 点击"反馈并重新生成"后，弹出反馈输入框
- 用户输入具体的修改建议
- 系统基于反馈重新调用 AI 生成新计划
- 原有的设置选项保持不变，用户无需重新填写
- 可循环反馈直到用户满意

---

## 3. 计划生成逻辑（AI服务）

### 输入数据结构
```json
{
  "subjectProgress": {
    "民法": { "status": "进行中", "progress": 65 },
    "刑法": { "status": "未开始", "progress": 0 },
    "行政法": { "status": "已完成", "progress": 100 }
  },
  "subjectOrder": ["民法", "刑法", "行政法", "诉讼法"],
  "orderMethod": "ai" | "manual",
  "dailyHours": 3,
  "weeklyDays": 5,
  "customNotes": "希望重点复习民法物权部分",
  "userFeedback": "上次计划太紧张了，希望轻松一些"
}
```

### AI 排序算法
当用户选择 AI 智能排序时：
1. **进度权重**：优先安排进度多的科目（60%权重）
2. **重要程度**：民法、刑法 > 行政法、诉讼法 > 其他（25%权重）
3. **难易程度**：优先安排较难科目（10%权重）
4. **关联性**：相关科目连续安排（5%权重）

### 计划生成算法
```pseudocode
1. 计算剩余学习量：
   for each subject:
     remaining[subject] = chapters[subject] * (1 - progress[subject])

2. 分配学习时间：
   totalRemaining = sum(remaining)
   dailyCapacity = dailyHours
   weeklyCapacity = dailyHours * weeklyDays
   
3. 按科目顺序分配：
   for each subject in subjectOrder:
     allocate time based on remaining workload
     
4. 生成三级计划 + 网站功能整合：
   - 日计划：具体章节 + 时长 + 对应网站功能使用建议
   - 周计划：章节组合 + 里程碑 + 功能应用策略
   - 月计划：科目完成时间 + 模拟考试 + 深度功能应用

5. 网站功能整合策略：
   - 知识导图：根据学习章节推荐相关知识点查看
   - AI问答：提供针对性问题建议和互动方向
   - 题库练习：匹配对应科目和章节的练习题
   - 笔记系统：建议笔记分类和整理方法
   - 学习进度：提醒更新进度和调整计划
```

---

## 4. API 接口设计

### 生成计划接口
```
POST /api/study-plan/generate
Content-Type: application/json

Request Body: {
  // 上面的输入数据结构
}

Response: {
  "success": true,
  "data": {
    "dailyPlan": [...],
    "weeklyPlan": [...],
    "monthlyPlan": [...]
  }
}
```

### 保存计划接口
```
POST /api/study-plan/save
Content-Type: application/json

Request Body: {
  "planData": { /* 计划数据 */ },
  "userId": "user_id"
}
```

---

## 5. 计划输出格式示例

### 1. 总体规划思路（独立展示）
```
🎯 学习计划总体策略
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📊 当前进度分析：
   • 民法进度：65%（物权编进行中）
   • 刑法进度：0%（未开始）
   • 距离考试：156天

🎯 学习目标设定：
   • 完成民法剩余35%内容（物权+债权+侵权）
   • 启动刑法总论学习（目标完成30%）
   • 通过知识导图建立跨科目知识联系
   
📚 学习策略：
   • 以教材+视频为主要学习方式
   • 充分利用8科目知识导图理解知识关联
   • 通过AI问答深度解决疑难问题
   • 系统练习历年真题巩固知识
   • 建立完整的学习笔记体系
```

### 2. 今日学习计划
```
📅 2024年X月X日学习计划 (总时长3小时)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📚 学前准备 (5分钟)
   📖 知识导图预习：浏览"民法-物权-抵押权"知识框架
   🔍 关联知识：查看抵押权与其他担保物权的关系
   💡 学习目标：深入理解抵押权的设立与效力

📖📺 教材+视频同步学习 (120分钟)
   • 配套学习：XX老师抵押权专题视频 + 教材对应章节
   • 学习方式：边看视频边对照教材，同步理解
   • 重点掌握：抵押合同要件、登记效力、实现方式
   • AI问答支持：遇到疑难概念可随时提问深度解析
   • 案例深化：结合视频案例和教材理论加深理解
   • 笔记记录：详细记录重要法条、案例和知识要点

✏️ 即学即练 (45分钟)
   📝 教材配套练习：完成相应章节课后习题
   📊 历年真题练习：选择抵押权相关真题进行训练
   ⭐ 错题收藏：将做错的重要题目加入错题集
   🤔 深度解析：对疑难题目请AI分析解题思路

🔄 学习总结 (10分钟)
   📝 笔记整理：整理今日学习的核心要点
   📊 知识关联：通过知识导图查看今日内容与其他知识点的联系
   💭 明日预习：简要了解明日学习内容
```

### 3. 本周学习计划
```
🗓️ 本周学习计划 (第X周)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🎯 本周目标：完成民法物权编（第1-4章）
⏰ 预计总时长：15小时（每天3小时 × 5天）
📊 进度目标：民法进度从65%提升至80%

📚 学习安排：

   📖 周一：物权概述与基本理论
   • 知识导图预习：浏览物权法在民法中的整体位置（5分钟）
   • 教材+视频同步学习：第1章配套视频课程（2小时）
   • AI深度问答：物权与债权的本质区别等基础问题
   • 历年真题练习：物权概述相关题目（30分钟）
   • 学习笔记：建立物权法学习笔记框架
   
   📖 周二：所有权制度
   • 教材+视频同步学习：第2章配套视频课程（2小时）
   • 知识导图应用：查看所有权相关知识点结构
   • 历年真题练习：所有权相关题目（30分钟）
   • AI问答：所有权限制、共有等复杂问题
   • 错题整理：收藏重要错题便于复习
   
   📖 周三：用益物权
   • 教材+视频同步学习：第3章配套视频课程（2小时）
   • 知识导图对比：通过导图对比各类用益物权特点
   • 历年真题练习：用益物权相关题目（30分钟）
   • AI深度解析：用益物权的设立与消灭等理论问题
   • 笔记补充：完善用益物权学习笔记
   
   📖 周四：担保物权（上）
   • 教材+视频同步学习：第4章前半部分配套视频（2小时）
   • 历年真题练习：抵押权相关题目（30分钟）
   • AI专项答疑：担保物权法条理解
   • 案例分析：结合视频案例深化理解
   • 知识整理：梳理担保物权重点内容
   
   📖 周五：担保物权（下）
   • 教材+视频同步学习：第4章后半部分配套视频（2小时）
   • AI学习总结：请AI帮助梳理本周学习重点
   • 知识导图复习：完整回顾物权法知识框架
   • 历年真题练习：质权、留置权相关题目（30分钟）
   • 学习进度：更新个人学习进度记录

🎯 周末巩固复习：
   📖 知识导图系统复习：完整浏览物权法知识体系
   📝 历年真题集中练习：物权法相关题目综合训练
   📓 笔记系统整理：完善本周学习笔记内容
   📊 错题专项复习：重点回顾本周错题集

💡 学习要点：
   • 充分利用8科目知识导图理解知识间的关联
   • 通过AI问答深度解决学习中的疑难问题
   • 系统练习历年真题掌握考试规律
   • 建立完整的学习笔记便于后续复习
   • 及时收藏错题形成个人错题库
```

---

## 6. 用户偏好记忆与一致性保证

### 6.1 用户选项记忆机制
```json
// 用户偏好存储结构
{
  "user_id": "unique_user_id",
  "learning_preferences": {
    "daily_hours": 3,
    "weekly_days": 5,
    "order_method": "ai", // "ai" | "manual"
    "learning_style": "video_text", // 学习方式偏好
    "difficulty_preference": "gradual", // 难度递进偏好
    "review_frequency": "weekly", // 复习频率偏好
    "last_updated": "2024-01-01T00:00:00Z"
  },
  "subject_preferences": {
    "民法": { "priority": "high", "difficulty": "medium" },
    "刑法": { "priority": "medium", "difficulty": "high" }
  },
  "historical_performance": {
    "completed_plans": 3,
    "average_completion_rate": 0.85,
    "preferred_study_times": ["09:00-12:00", "19:00-22:00"]
  }
}
```

### 6.2 计划一致性保证机制
```pseudocode
生成新计划时的冲突检测:
1. 检查历史计划执行情况
   if (previous_plan.completion_rate < 0.5):
     adjust_difficulty_down()
     
2. 检查时间分配合理性
   if (new_plan.daily_hours > user_preferences.max_daily_hours):
     warning_and_suggest_adjustment()
     
3. 检查科目顺序一致性
   if (user_preferences.order_method == "manual"):
     preserve_user_defined_order()
   else:
     apply_ai_optimization_with_user_history()
     
4. 检查学习节奏连贯性
   ensure_no_subject_gaps_longer_than(7_days)
   maintain_review_cycle_consistency()
```

### 6.3 冲突预防策略
- **进度冲突**：新计划必须基于最新的学习进度
- **时间冲突**：避免超出用户历史最大承受能力
- **内容冲突**：确保前后计划的知识点衔接合理
- **难度冲突**：根据用户完成情况动态调整难度

---

## 7. 开发任务清单
- [ ] 前端：多步骤问卷组件开发
- [ ] 前端：进度滑块组件（章节显示）
- [ ] 前端：科目排序拖拽功能
- [ ] 前端：计划预览与反馈界面（总体思路+日计划+周计划三部分展示）
- [ ] 后端：用户偏好存储表设计与API
- [ ] 后端：AI 智能排序算法
- [ ] 后端：计划生成 AI Prompt 优化（确保输出三级结构）
- [ ] 后端：计划一致性检测算法
- [ ] 后端：计划数据存储结构设计
- [ ] 后端：冲突预防与历史计划分析功能
- [ ] 测试：完整流程用户体验测试
- [ ] 测试：多次生成计划的一致性验证 