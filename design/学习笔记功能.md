# 法考学习笔记功能设计

## 功能描述

学习笔记功能是"学习搭子"平台的个人知识管理工具，旨在帮助用户有效记录、整理和回顾法考学习过程中的重要内容。该功能允许用户在法考问答页面侧边栏直接创建和管理笔记，支持文字输入和图片上传，提供基础的文本格式化工具，帮助用户构建个性化的法考知识体系。学习笔记功能不仅是知识存储的工具，更是学习过程中思考和整理的辅助手段，通过与平台其他功能（如AI问答、知识导图）的联动，为用户提供完整的学习闭环，增强学习效果和备考效率。

## 功能实现流程

### 1. 笔记创建与编辑流程

1. **入口访问**：
   - 用户在"法考问答"页面的侧边栏选择"学习笔记"
   - 系统展示用户已有笔记列表
   - 提供"新建笔记"按钮

2. **新建笔记**：
   - 用户点击"新建笔记"按钮
   - 系统打开笔记编辑界面
   - 用户输入笔记标题和内容
   - 提供笔记分类选项（可按学科分类）
   - 用户点击"保存"完成创建

3. **内容编辑**：
   - 提供基础文本编辑功能：
     - 文字输入
     - 段落设置
     - 文本格式化（加粗、斜体、下划线等）
     - 文字大小调整
     - 文字背景色调整
   - 支持图片上传和插入
   - 支持简单的表格创建

4. **笔记保存**：
   - 实时自动保存功能，避免内容丢失
   - 用户可手动保存笔记
   - 保存成功后显示确认提示
   - 将笔记与用户账户关联存储

### 2. 笔记管理与查看流程

1. **笔记列表**：
   - 按创建时间倒序展示用户笔记
   - 显示笔记标题、创建时间、最后更新时间
   - 提供按学科、时间筛选功能
   - 支持笔记标题和内容搜索

2. **笔记查看**：
   - 用户点击笔记标题打开笔记详情
   - 展示完整笔记内容（包括文字和图片）
   - 提供"编辑"、"删除"、"返回列表"等操作按钮

3. **笔记编辑**：
   - 用户点击"编辑"进入编辑模式
   - 可修改笔记标题和内容
   - 编辑完成后点击"保存"更新笔记

4. **笔记删除**：
   - 用户点击"删除"按钮
   - 系统弹出确认对话框
   - 用户确认后执行删除操作
   - 删除成功后返回笔记列表

### 3. 笔记与其他功能联动流程

1. **AI问答联动**：
   - 用户在AI问答时，可一键将回答保存为笔记
   - 系统自动将回答内容填入新笔记
   - 用户可编辑调整后保存

2. **知识导图联动**（会员功能）：
   - 在查看知识导图时，用户可为特定知识点添加笔记
   - 系统自动关联笔记与知识点
   - 用户再次查看该知识点时，可看到关联笔记提示

3. **真题库联动**（会员功能）：
   - 在真题练习过程中，可针对题目创建学习笔记
   - 系统自动关联笔记与题目ID
   - 复习相同题目时，可查看之前的相关笔记

## 业务规则

### 1. 用户权限控制

- **免费用户**：
  - 无法使用学习笔记功能
  - 点击相关入口时提示升级会员
  - 可查看学习笔记功能介绍和示例

- **会员用户**：
  - 可完整使用所有学习笔记功能
  - 无限制创建和管理笔记
  - 笔记存储无容量限制
  - 可使用笔记与其他功能的联动特性

### 2. 笔记内容规则

- 笔记标题长度上限为50个字符
- 笔记内容无字数限制
- 单条笔记最多可插入10张图片
- 每张图片大小不超过5MB
- 支持的图片格式：PNG、JPG、JPEG、GIF
- 文本格式化仅支持基础样式（加粗、斜体、下划线、颜色）

### 3. 笔记管理规则

- 笔记按创建时间自动排序，最新创建的显示在前
- 用户可手动设置笔记的置顶状态
- 笔记操作（创建、编辑、删除）均在系统中记录日志
- 一条笔记可同时关联多个知识点或题目
- 用户删除笔记前需二次确认
- 被删除的笔记在30天内可从"回收站"恢复

### 4. 数据安全规则

- 笔记数据仅对创建者可见
- 系统定期备份笔记数据，防止意外丢失
- 用户笔记不会被用于训练AI模型
- 会员到期后，笔记数据保留但无法访问，续费后可恢复访问

## 使用角色

### 1. 普通用户

- **会员用户**：
  - 创建、编辑和管理个人学习笔记
  - 将AI回答、知识点、真题关联到笔记
  - 通过笔记整理和复习知识点
  - 搜索和查看自己的所有笔记

### 2. 系统管理员

- 监控笔记功能的整体使用情况
- 管理笔记数据的备份和恢复
- 处理用户反馈的功能问题
- 分析笔记使用数据，优化用户体验

## 界面设计要求

### 1. 笔记列表页面

- **布局**：
  - 简洁的列表式布局
  - 左侧为笔记分类或筛选区
  - 右侧为笔记列表主区域
  - 顶部提供搜索框和"新建笔记"按钮

- **笔记项展示**：
  - 卡片式设计，每条笔记一个卡片
  - 显示笔记标题、创建时间、最后更新时间
  - 预览笔记内容的前几行
  - 提供快捷操作按钮（编辑、删除）

- **交互设计**：
  - 点击笔记卡片进入详情
  - 滑动加载更多笔记（无限滚动）
  - 提供列表/网格两种视图切换选项
  - 拖拽功能支持调整笔记顺序

### 2. 笔记编辑页面

- **布局**：
  - 顶部为标题输入区和工具栏
  - 中部为主要编辑区域
  - 底部为操作按钮区（保存、取消）

- **编辑工具栏**：
  - 文本格式化工具（加粗、斜体、下划线）
  - 文字大小和颜色调整
  - 图片上传按钮
  - 表格插入工具
  - 撤销/重做按钮

- **编辑区设计**：
  - 所见即所得的编辑体验
  - 支持拖拽调整图片位置
  - 自动保存提示（显示最近保存时间）
  - 字数统计显示

- **响应式设计**：
  - 适配不同屏幕尺寸
  - 移动端优化的编辑体验
  - 触控友好的操作方式

### 3. 笔记查看页面

- **布局**：
  - 干净整洁的阅读界面
  - 顶部显示笔记标题和创建时间
  - 右上角提供编辑、删除等操作按钮

- **内容展示**：
  - 保持格式的完整呈现
  - 图片自适应显示
  - 表格结构清晰展示

- **相关内容**：
  - 如有关联的知识点或真题，在底部显示链接
  - 提供快速跳转到相关内容的选项

## 技术实现要点

### 1. 前端技术

- **框架**：React.js
- **UI组件**：Ant Design
- **编辑器**：基于Draft.js或Quill.js的富文本编辑器
- **状态管理**：Redux管理笔记状态
- **图片处理**：使用browser-image-compression进行上传前压缩
- **响应式设计**：使用Flexbox和Grid布局

### 2. 后端技术

- **框架**：Node.js + Express.js
- **API设计**：RESTful API为前端提供笔记的CRUD操作
- **数据处理**：图片存储与处理，文本内容解析与存储
- **搜索功能**：基于ElasticSearch实现全文检索

### 3. 数据存储

- **笔记内容**：MongoDB存储笔记文本和元数据
- **图片存储**：对象存储服务（如AWS S3）存储用户上传图片
- **关联数据**：记录笔记与知识点/题目的关联关系
- **用户数据**：将笔记ID与用户账户关联

### 4. 性能优化

- **编辑器延迟加载**：减少初始页面加载时间
- **图片懒加载**：提升长笔记的加载性能
- **数据分页**：大量笔记采用分页加载
- **自动保存**：使用防抖技术减少保存请求频率
- **离线编辑**：支持无网络环境的暂存和同步

## 安全与测试

### 1. 安全措施

- **数据隔离**：严格保障不同用户间的笔记数据隔离
- **内容过滤**：防止XSS攻击的输入内容过滤
- **权限验证**：每次操作验证用户身份和权限
- **加密传输**：使用HTTPS保护数据传输安全

### 2. 测试计划

- **功能测试**：
  - 验证笔记的创建、编辑、删除基本操作
  - 测试各种格式（文本、图片、表格）的正确展示
  - 验证笔记与其他功能的联动效果

- **兼容性测试**：
  - 跨浏览器兼容性测试（Chrome、Firefox、Safari、Edge）
  - 不同设备响应式展示测试（桌面、平板、手机）
  - 不同网络环境下的性能表现

- **性能测试**：
  - 大量笔记时的加载和渲染性能
  - 图片上传和处理的响应时间
  - 编辑大型笔记时的实时保存性能

## 未来扩展计划

1. **协作笔记**：
   - 支持多用户协同编辑同一篇笔记
   - 实时同步更新内容
   - 编辑历史记录和版本对比
   - 权限管理（查看、编辑、管理）

2. **高级编辑功能**：
   - 支持Markdown语法
   - 代码块高亮显示
   - LaTeX公式编辑
   - 页面内目录自动生成

3. **智能整理功能**：
   - 基于AI自动标记笔记关键词
   - 智能推荐相关笔记
   - 自动生成知识结构图
   - 记忆曲线提醒复习

4. **多媒体支持**：
   - 音频录制和嵌入
   - 视频链接嵌入
   - 思维导图创建工具
   - 手写笔记识别转文本

5. **导入导出功能**：
   - 支持PDF、Word、Markdown格式的导入导出
   - 一键导出所有笔记的备份
   - 从其他笔记软件批量导入
   - 生成精美PDF学习资料 