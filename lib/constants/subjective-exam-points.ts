// 法考主观题考点分布（基于历年真题分析）
export const SUBJECTIVE_EXAM_POINTS = {
  '民法': {
    // 主观题常考章节
    highFrequency: [
      '民法总则编第五章民事法律行为', // 合同效力认定
      '合同编第二章合同的订立', // 要约承诺、合同成立
      '合同编第三章合同的效力', // 效力瑕疵合同
      '合同编第八章违约责任', // 违约责任承担
      '物权编第二章所有权', // 物权变动、善意取得
      '物权编第四章担保物权', // 抵押权、质权设立和实现
      '侵权责任编', // 侵权责任认定和承担
    ],
    // 具体考点和建议提问
    chapterDetails: {
      '民法总则编第五章民事法律行为': {
        keyPoints: ['意思表示瑕疵', '无效民事法律行为', '可撤销民事法律行为', '效力待定民事法律行为'],
        aiQuestions: [
          '请详细分析意思表示错误与欺诈的区别，并举例说明',
          '无效民事法律行为的情形有哪些？如何认定？',
          '效力待定合同的追认权行使有什么限制？'
        ]
      },
      '合同编第二章合同的订立': {
        keyPoints: ['要约与要约邀请', '承诺的生效时间', '合同成立的时间地点', '格式条款'],
        aiQuestions: [
          '如何区分要约和要约邀请？请结合商业广告的案例分析',
          '承诺生效的时间如何确定？迟到的承诺如何处理？',
          '格式条款的效力认定规则是什么？'
        ]
      },
      '物权编第四章担保物权': {
        keyPoints: ['抵押权设立', '抵押权实现', '质权设立', '担保物权竞合'],
        aiQuestions: [
          '动产抵押权与动产质权如何区分？设立要件有何不同？',
          '同一财产上多个担保物权的清偿顺序如何确定？',
          '流押条款为什么无效？有哪些替代方案？'
        ]
      }
    }
  },
  
  '刑法': {
    highFrequency: [
      '刑法总则第二章犯罪', // 犯罪构成、共同犯罪
      '刑法总则第三章刑罚', // 量刑、数罪并罚
      '刑法分则第四章侵犯公民人身权利民主权利罪', // 故意杀人、故意伤害、非法拘禁
      '刑法分则第五章侵犯财产罪', // 盗窃、抢劫、诈骗、侵占
      '刑法分则第六章妨害社会管理秩序罪', // 寻衅滋事、聚众斗殴
    ],
    chapterDetails: {
      '刑法总则第二章犯罪': {
        keyPoints: ['犯罪构成四要件', '正当防卫', '紧急避险', '共同犯罪'],
        aiQuestions: [
          '如何认定正当防卫的"不法侵害正在进行"？',
          '共同犯罪中主犯、从犯、胁从犯如何区分？',
          '犯罪中止与犯罪未遂的区别标准是什么？'
        ]
      },
      '刑法分则第五章侵犯财产罪': {
        keyPoints: ['盗窃罪认定', '抢劫罪转化', '诈骗罪构成', '职务侵占与侵占'],
        aiQuestions: [
          '盗窃罪既遂的标准是什么？控制说vs失控说',
          '入户盗窃、携带凶器盗窃如何转化为抢劫？',
          '诈骗罪中"非法占有目的"如何认定？'
        ]
      }
    }
  },
  
  '刑诉法': {
    highFrequency: [
      '刑事诉讼法第五章证据', // 证据种类、非法证据排除
      '刑事诉讼法第六章强制措施', // 拘留、逮捕程序
      '刑事诉讼法第十二章审判', // 一审程序、二审程序
    ],
    chapterDetails: {
      '刑事诉讼法第五章证据': {
        keyPoints: ['证据种类', '非法证据排除', '证明标准', '证据审查'],
        aiQuestions: [
          '非法证据排除规则的适用范围是什么？',
          '刑事诉讼的证明标准"排除合理怀疑"如何理解？',
          '瑕疵证据与非法证据的区别是什么？'
        ]
      }
    }
  },
  
  '商法': {
    highFrequency: [
      '公司法第二章有限责任公司的设立和组织机构', // 股东会、董事会决议
      '公司法第五章公司董事监事高级管理人员的资格和义务', // 董监高责任
      '合伙企业法', // 合伙人责任承担
    ],
    chapterDetails: {
      '公司法第二章有限责任公司的设立和组织机构': {
        keyPoints: ['股东会决议', '董事会职权', '法定代表人', '公司章程'],
        aiQuestions: [
          '股东会决议瑕疵的类型有哪些？如何救济？',
          '公司法定代表人越权行为的效力如何认定？',
          '一人有限公司与普通有限公司的区别是什么？'
        ]
      }
    }
  },
  
  '行政法': {
    highFrequency: [
      '行政法第三章行政行为', // 具体行政行为认定
      '行政法第五章行政复议', // 复议范围、程序
      '行政法第六章行政诉讼', // 诉讼管辖、原告资格
    ],
    chapterDetails: {
      '行政法第三章行政行为': {
        keyPoints: ['行政行为效力', '行政行为撤销', '行政裁量', '行政行为无效'],
        aiQuestions: [
          '行政行为的公定力如何理解？有哪些例外？',
          '行政裁量权的滥用如何认定？',
          '无效行政行为与可撤销行政行为的区别？'
        ]
      }
    }
  }
}

// 判断某个章节是否涉及主观题
export function hasSubjectiveExam(subject: string, chapter: string): boolean {
  const subjectData = SUBJECTIVE_EXAM_POINTS[subject]
  if (!subjectData) return false
  
  return subjectData.highFrequency.some(ch => chapter.includes(ch))
}

// 获取章节的主观题重点
export function getSubjectivePoints(subject: string, chapter: string) {
  const subjectData = SUBJECTIVE_EXAM_POINTS[subject]
  if (!subjectData) return null
  
  // 查找匹配的章节
  for (const [key, value] of Object.entries(subjectData.chapterDetails)) {
    if (chapter.includes(key)) {
      return value
    }
  }
  
  return null
}

// 每日任务重点章节建议
export const CHAPTER_STUDY_TASKS = {
  '民法总则编第一章自然人': {
    tasks: [
      '掌握完全民事行为能力、限制民事行为能力、无民事行为能力的年龄界限',
      '理解监护制度：法定监护人顺序、指定监护、监护人职责',
      '宣告失踪与宣告死亡的条件、程序、法律后果',
      '个体工商户与农村承包经营户的民事责任承担'
    ],
    aiQuestions: [
      '8周岁、16周岁、18周岁在民事行为能力认定中的意义？',
      '宣告死亡后又出现，其婚姻关系如何处理？',
      '监护人处分被监护人财产的限制条件是什么？'
    ]
  },
  
  '民法总则编第五章民事法律行为': {
    tasks: [
      '区分无效、可撤销、效力待定三类效力瑕疵行为',
      '掌握意思表示的解释规则（文义解释、目的解释、习惯解释）',
      '理解欺诈、胁迫、重大误解、显失公平的认定标准',
      '熟悉无权代理与表见代理的构成要件'
    ],
    aiQuestions: [
      '如何区分重大误解与欺诈？两者的法律后果有何不同？',
      '表见代理的构成要件是什么？相对人需要证明什么？',
      '恶意串通损害第三人利益的合同效力如何？'
    ]
  },
  
  '刑法总则第二章犯罪': {
    tasks: [
      '掌握犯罪构成四要件及其逻辑关系',
      '区分作为犯与不作为犯，理解不作为犯的义务来源',
      '理解因果关系的判断（条件说、相当因果关系说）',
      '掌握正当防卫的五个条件及防卫过当的认定'
    ],
    aiQuestions: [
      '不作为犯的作为义务有哪几种来源？请举例说明',
      '如何认定防卫过当？"明显超过必要限度"如何判断？',
      '共同犯罪中实行过限的责任如何承担？'
    ]
  },
  
  '合同编第二章合同的订立': {
    tasks: [
      '区分要约与要约邀请（重点：商业广告的性质认定）',
      '掌握要约的撤回、撤销规则及限制',
      '理解承诺的方式、期限及迟到承诺的处理',
      '熟悉合同成立的时间、地点规则'
    ],
    aiQuestions: [
      '悬赏广告是要约还是要约邀请？法律依据是什么？',
      '电子合同的成立时间如何确定？',
      '要约不可撤销的情形有哪些？'
    ]
  }
}

// 获取具体的每日任务
export function getDailyTasks(subject: string, chapter: string): { tasks: string[], aiQuestions: string[] } {
  // 先尝试精确匹配
  for (const [key, value] of Object.entries(CHAPTER_STUDY_TASKS)) {
    if (chapter.includes(key)) {
      return value
    }
  }
  
  // 如果没有精确匹配，返回通用任务模板
  return {
    tasks: [
      `理解${chapter}的核心概念和基本原理`,
      `掌握本章节涉及的重要法条`,
      `梳理本章节的知识体系和逻辑关系`,
      `完成本章节配套练习题`
    ],
    aiQuestions: [
      `${chapter}的核心法条有哪些？请详细解释`,
      `本章节最常见的考点是什么？`,
      `请对比分析本章节易混淆的概念`
    ]
  }
}