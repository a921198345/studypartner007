<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>侧边栏优化测试</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .test-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        h2 {
            margin-top: 0;
            color: #333;
        }
        .sidebar-demo {
            width: 260px;
            height: 400px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            overflow: hidden;
            background: #f9fafb;
        }
        .conversation-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px 12px;
            margin: 4px 8px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            border: 1px solid transparent;
        }
        .conversation-item:hover {
            background: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border-color: #e5e7eb;
        }
        .conversation-item.active {
            background: linear-gradient(to right, #eff6ff, #dbeafe);
            color: #1d4ed8;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border-color: #93c5fd;
        }
        .icon {
            width: 16px;
            height: 16px;
            flex-shrink: 0;
            color: #9ca3af;
        }
        .conversation-item.active .icon {
            color: #2563eb;
        }
        .title-container {
            flex: 1;
            min-width: 0;
            margin-right: 8px;
        }
        .title {
            display: block;
            font-size: 14px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        .delete-btn {
            position: absolute;
            right: 8px;
            padding: 6px;
            border-radius: 4px;
            opacity: 0;
            visibility: hidden;
            transition: all 0.2s;
        }
        .conversation-item:hover .delete-btn,
        .conversation-item.active .delete-btn {
            opacity: 1;
            visibility: visible;
        }
        .delete-btn:hover {
            background: #fee2e2;
        }
        .test-case {
            margin: 10px 0;
            padding: 10px;
            background: #f9fafb;
            border-radius: 4px;
        }
        .success {
            color: #059669;
            font-weight: 500;
        }
        .feature-list {
            list-style: none;
            padding: 0;
        }
        .feature-list li {
            padding: 8px 0;
            border-bottom: 1px solid #e5e7eb;
        }
        .feature-list li:last-child {
            border-bottom: none;
        }
        .check {
            color: #10b981;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>法考助手 - 侧边栏优化测试</h1>
        
        <div class="test-section">
            <h2>🎯 实现的功能</h2>
            <ul class="feature-list">
                <li><span class="check">✓</span><strong>返回上次对话：</strong>用户点击法考问答按钮进入页面时，自动返回到上次离开时的对话</li>
                <li><span class="check">✓</span><strong>自动滚动到底部：</strong>返回对话后自动滚动到最下方，看到最新内容</li>
                <li><span class="check">✓</span><strong>标题省略号优化：</strong>侧边栏中过长的对话标题使用CSS省略号显示，更加美观</li>
                <li><span class="check">✓</span><strong>标题悬浮提示：</strong>鼠标悬浮在截断的标题上时显示完整内容</li>
            </ul>
        </div>
        
        <div class="test-section">
            <h2>📱 侧边栏标题显示效果</h2>
            <div class="sidebar-demo">
                <!-- 模拟侧边栏 -->
                <div style="padding: 16px;">
                    <h3 style="font-size: 12px; color: #6b7280; text-transform: uppercase; margin: 0 0 8px 8px;">今天</h3>
                    
                    <!-- 正常长度标题 -->
                    <div class="conversation-item">
                        <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                        </svg>
                        <div class="title-container">
                            <span class="title">什么是有偿合同？</span>
                        </div>
                        <div class="delete-btn">🗑️</div>
                    </div>
                    
                    <!-- 长标题（会被截断） -->
                    <div class="conversation-item active">
                        <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                        </svg>
                        <div class="title-container">
                            <span class="title" title="实践合同和诺成合同的区别是什么？请详细解释两者的定义、成立要件、典型例子以及在实务中的应用">实践合同和诺成合同的区别是什么？请详细解释两者的定义、成立要件、典型例子以及在实务中的应用</span>
                        </div>
                        <div class="delete-btn">🗑️</div>
                    </div>
                    
                    <!-- 超长标题 -->
                    <div class="conversation-item">
                        <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                        </svg>
                        <div class="title-container">
                            <span class="title" title="正当防卫、紧急避险和犯罪构成之间的关系如何理解？它们在刑法理论中的地位是怎样的？请结合具体案例分析">正当防卫、紧急避险和犯罪构成之间的关系如何理解？它们在刑法理论中的地位是怎样的？请结合具体案例分析</span>
                        </div>
                        <div class="delete-btn">🗑️</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="test-section">
            <h2>🧪 测试用例</h2>
            
            <div class="test-case">
                <strong>测试1：返回上次对话</strong>
                <ol>
                    <li>创建多个对话</li>
                    <li>在某个对话中输入多条消息</li>
                    <li>离开法考问答页面</li>
                    <li>重新点击法考问答按钮</li>
                    <li class="success">✓ 应该自动显示上次的对话内容</li>
                </ol>
            </div>
            
            <div class="test-case">
                <strong>测试2：自动滚动</strong>
                <ol>
                    <li>进入有历史消息的对话</li>
                    <li>观察页面加载行为</li>
                    <li class="success">✓ 应该自动滚动到最底部，显示最新消息</li>
                </ol>
            </div>
            
            <div class="test-case">
                <strong>测试3：标题截断</strong>
                <ol>
                    <li>输入一个很长的问题</li>
                    <li>查看侧边栏显示</li>
                    <li class="success">✓ 长标题应该以省略号结尾</li>
                    <li class="success">✓ 鼠标悬浮应显示完整标题</li>
                </ol>
            </div>
        </div>
        
        <div class="test-section">
            <h2>💻 技术实现</h2>
            <h3>返回上次对话逻辑</h3>
            <pre style="background: #f3f4f6; padding: 15px; border-radius: 6px; overflow-x: auto;">
// 初始化对话 - 返回上次对话或创建新对话
useEffect(() => {
  if (mounted) {
    // 检查是否有历史对话
    if (conversations.length > 0 && !currentConversationId) {
      // 获取最近的对话（已按更新时间排序）
      const lastConversation = conversations[0];
      switchConversation(lastConversation.id);
      
      // 滚动到底部
      setTimeout(() => {
        if (scrollAreaRef.current) {
          const scrollContainer = scrollAreaRef.current.querySelector('[data-radix-scroll-area-viewport]');
          if (scrollContainer) {
            scrollContainer.scrollTop = scrollContainer.scrollHeight;
          }
        }
        messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
      }, 200);
    }
  }
}, [mounted]);</pre>

            <h3>CSS省略号实现</h3>
            <pre style="background: #f3f4f6; padding: 15px; border-radius: 6px; overflow-x: auto;">
// 组件结构
&lt;div className="flex-1 min-w-0 mr-2"&gt;
  &lt;span 
    className="block text-sm truncate transition-colors"
    title={title}  // 完整标题作为悬浮提示
  &gt;
    {title}
  &lt;/span&gt;
&lt;/div&gt;

// CSS类说明
// truncate = overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
// min-w-0 = 确保flex子元素可以收缩
// block = 使span成为块级元素以应用截断</pre>
        </div>
    </div>
</body>
</html>